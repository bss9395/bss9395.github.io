---
layout:    zh_post
Topic:     概率统计
Title:     统计模拟
Revised:   2018-06-05 17:52:00 +08 @ 中国-新疆-乌鲁木齐 +06
Authors:   璀璨星辰
Resources:
---

> ### 随机模拟法计算定积分

> 设 $0 \le f (x) \le 1$，求 $f (x)$ 在区间 $[0, 1]$ 上的积分值：
> 
> $$
> J = \int_0^1 f (x) \mathrm{d} x
> $$
> 
> 设二维随机变量 $(X, Y)$ 服从正方形 $\lbrace 0 \le x \le 1, 0 \le y \le 1 \rbrace$ 上的均匀分布，则可知 $X$ 服从 $[0, 1]$ 上的均匀分布，$Y$ 也服从 $[0, 1]$ 上的均匀分布，且 $X$ 与 $Y$ 独立。又记事件：
>
> $$
> A = \lbrace Y \le f (X) \rbrace
> $$
> 
> 则 $A$ 的概率为：
> 
> $$
> p = P (Y \le f (X)) = \int_0^1 \int_0^{f (x)} \mathrm{d} y \mathrm{d} x = \int_0^1 f (x) \mathrm{d} x = J
> $$
> 
> 即定积分的值 $J$ 就是事件 $A$ 的概率 $p$。由伯努利大数定律，我们可以用重复试验中 $A$ 出现的频率作为 $p$ 的估计值。这种求定积分的方法也称为随机投点法，即将 $(X, Y)$ 看成是向正方形 $\lbrace 0 \le x \le 1, 0 \le y \le 1 \rbrace$ 内的随机投的点，用随机点落在区域 $\lbrace y \le f (x) \rbrace$ 中的频率作为定积分的近似值。
>
> 下面用蒙特卡罗方法得到 $A$ 出现的频率：
>
> （1）先用计算机产生 $(0, 1)$ 上均匀分布的 $2 n$ 个随机数，组成 $n$ 对随机数 $(x_i, y_i), i = 1, 2, \cdots, n$，这里 $n$ 可以很大，譬如 $n = 10^4$，甚至 $n = 10^5$。
>
> （2）对 $n$ 对数据 $(x_i, y_i), i = 1, 2, \cdots, n$，记录满足如下不等式：
> 
> $$
> y_i \le f (x_i)
> $$
> 
> 的次数，这就是事件 $A$ 发生的频数 $S_n$。由此可得事件 $A$ 发生的频率 $\dfrac{S_n}{n}$，则 $J \approx \dfrac{S_n}{n}$。
>
> 譬如计算 $\dfrac{1}{\sqrt{2\pi}} \displaystyle\int_0^1 e^{- \frac{x^2}{2}} \mathrm{d} x$，其精确值和在 $n = 10^4, n = 10^5$ 时的模拟值如下：
> 
> $$
> \begin{array}{|l|l|l|}
> \hline
> \text{Accurate Value} & n = 10^4     & n = 10^5 \\
> \hline
> 0.341 \, 344          & 0.340 \, 698 & 0.341 \, 355 \\
> \hline
> \end{array}
> $$
> 
> 注意，对于一般区间 $[a, b]$ 上的定积分：
> 
> $$
> J' = \int_a^b g (x) \mathrm{d} x
> $$
> 
> 做线性变换 $y = \dfrac{x - a}{b - a}$，即可化成 $[0, 1]$ 区间上的积分。进一步若 $c \le g (x) \le d$，可令：
> 
> $$
> f (y) = \dfrac{1}{d - c} [g (a + ( b - a) y) - c]
> $$
> 
> 则 $0 \le f (y) \le 1$。此时有：
> 
> $$
> J' = \int_a^b g (x) \mathrm{d} x = S_0 \int_0^1 f (y) \mathrm{d} y + c (b - a)
> $$
> 
> 其中 $S_0 = \dfrac{b - a}{d - c}$。这说明以上用蒙特卡罗方法计算定积分方法带有普遍意义。

> ——《$\S$ 4.3 大数定律》
> ——《概率论与数理统计教程(第二版)》茆诗松/程依明/濮晓龙/编著

> ### 平均值法计算定积分

> 计算定积分：
> 
> $$
> J = \int_0^1 f (x) \mathrm{d} x
> $$
> 
> 设随机变量 $X$ 服从 $(0, 1)$ 上的均匀分布，则 $Y = f (X)$ 的数学期望为：
> 
> $$
> E (f (X)) = \int_0^1 f (x) \mathrm{d} x = J
> $$
> 
> 所以估计 $J$ 的值就是估计 $f (X)$ 的数学期望的值。由辛钦大数定律，可以用 $f (X)$ 的观察值的平均去估计 $f (X)$ 的数学期望的值。具体做法如下：先用计算机产生 $n$ 个 $(0, 1)$ 上均匀分布的随机数 $x_i, i = 1, 2, \cdots, n$，然后对每个 $x_i$ 计算 $f (x_i)$，最后得 $J$ 的估计值为：
> 
> $$
> J \approx \dfrac{1}{n} \sum_{i = 1}^n f (x_i)
> $$
> 
> 譬如计算 $\dfrac{1}{\sqrt{2 \pi}} \displaystyle\int_0^1 e^{- \frac{x^2}{2}} \mathrm{d} x$，其精确值和在 $n = 10^4, n = 10^5$ 时的一次模拟值如下：
> 
> $$
> \begin{array}{|l|l|l|}
> \hline
> \text{Accurate Value} & n = 10^4     & n = 10^5 \\
> \hline
> 0.341 \, 344          & 0.341 \, 329 & 0.341 \, 334 \\
> \hline
> \end{array}
> $$
> 
> 可以通过线性变换将 $[a, b]$ 区间上的定积分化成 $[0, 1]$ 区间上的定积分，所以用以上方法计算定积分方法带有普遍意义。

> ——《$\S$ 4.3 大数定律》
> ——《概率论与数理统计教程(第二版)》茆诗松/程依明/濮晓龙/编著
