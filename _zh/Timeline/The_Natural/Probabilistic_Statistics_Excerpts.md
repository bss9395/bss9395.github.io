---
layout:    zh_post
Topic:     顺其自然
Title:     概率统计摘录
Revised:   2019-03-05 15:48:00 +08 @ 中国-广东-湛江 +08
Authors:   璀璨星辰
Resources:
---

### 后验概率

——摘录自《概率论与数理统计教程（第二版）》ISBN:978-7-04-031210-2，茆诗松/程依明/濮晓龙

**条件概率的定义**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
所谓条件概率，它是指在某事件B发生的条件下，求另一事件A的概率，记为P(A|B)，它与P(A)是不同的两类概率。

例 考察有两个小孩的家庭，其样本空间为\Omega = \lbrace bb, bg, gb, gg \rbrace，其中b代表男孩，g代表女孩，bg表示大的是男孩、小的是女孩。其他样本点可类似说明。

在\Omega中4个样本点等可能情况下，我们来讨论如下一些事件的概率。

（1）事件A=“家中至少有一个女孩”发生的概率为

P(A) = \dfrac{3}{4}

（2）若已知事件B=“家中至少有一个男孩”发生，再求事件A发生的概率为

P(A|B) = \dfrac{2}{3}

这是因为事件B的发生，排除了gg发生的可能性，这是样本空间\Omega也随之改为\Omega_B=\lbrace bb, bg, gb \rbrace，而在\Omega_B中事件A只含2个样本点，故P(A|B) = \dfrac{2}{3}。这就是条件概率，它与（无条件）概率P(A)是不同的两个概念。

（3）若对上述条件概率的分子分母各除以4，则可得

P(A|B) = \dfrac{\frac{2}{4}}{\frac{3}{4}} = \dfrac{P(AB)}{P(B)}

其中交事件AB=“家有一男一女两个小孩”。

这个关系具有一般性，即条件概率是两个无条件概率之商，这就是条件概率的定义。

定义 设A与B是样本空间\Omega中的两事件，若P(B)>0, 则称

P(A|B) = \dfrac{P(AB)}{P(B)}

为“在B发生下A的条件概率”，简称条件概率。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**乘法公式**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
性质 乘法公式

（1）若P(B)>0，则

P(AB) = P(B) P(A|B)

（2）若P(A_1 A_2 \cdots A_{n - 1})>0，则

P(A_1 \cdots A_n) = P(A_1) P(A_2|A_1) P(A_3|A_1 A_2) \cdots P(A_n|A_1 \cdots A_{n - 1})

证明 由条件概率的定义，移项即得（1）式。下证（2）式，因为

P(A_1) ≥ P(A_1 A_2) ≥ \cdots ≥ P(A_1 \cdots A_{n - 1}) > 0

所以（2）式中的条件概率均有意义，且按条件概率的定义，（2）式的右边等于

P(A_1) · \dfrac{P(A_1 A_2)}{P(A_1)} · \dfrac{P(A_1 A_2 A_3)}{P(A_1 A_2)} \cdots \dfrac{P(A_1 \cdots A_n)}{P(A_1 \cdots A_{n - 1})} = P(A_1 \cdots A_n)

从而（2）式成立。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**全概率公式**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
全概率公式是概率论中的一个重要公式，它提供了计算复杂事件概率的一条有效途径，使一个复杂事件的概率计算问题化繁就简。

性质（全概率公式） 设B_1, B_2, \cdots, B_n为样本空间\Omega的一个分割，即B_1, B_2, \cdots, B_n互不相容，且\bigcup\limit_{i = 1}^n B_i = \Omega，如果P(B_i)>0, i = 1, 2, \cdots, n，则对任一事件A有

P(A) = \sum_{i = 1}^n P(B_i) P(A|B_i)

证明 因为

A = A \Omega = A \left( \bigcup_{i = 1}^n B_i \right) = \bigcup_{i = 1}^n (A B_i)

且AB_1, AB_2, \cdots, AB_n互不相容，所以由可加性得

P(A) = P \left( \bigcup_{i = 1}^n (A B_i) \right) = \sum_{i = 1)^n P(A B_i)

再将P(A B_i) = P(B_i) P(A|B_i), i = 1, 2, \cdots, n，代入上式即得全概率公式。

对于全概率公式，我们要注意以下两点：

（1）全概率公式的最简单形式 假如0<P(B)<1，则

P(A) = P(B) P(A|B) + P(\bar{B}) P(A|\bar{B})

（2）条件B_1, B_2, \cdots, B_n为样本空间的一个分割，可改成B_1, B_2, \cdots, B_n互不相容，且A \subset \bigcup\limit_{i = 1}^n B_i，乘法公式仍然成立。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**贝叶斯公式**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
在乘法公式和全概率公式的基础上立即可推得一个很著名的公式。

性质（贝叶斯公式） 设B_1, B_2, \cdots, B_n是样本空间\Omega的一个分割，即B_1, B_2, \cdots, B_n互不相容，且\bigcup\limits_{i = 1}^n B_i = \Omega，如果P(A) > 0, P(B_i) > 0, i = 1, 2, \cdots, n，则

P(B_i|A) = \dfrac{P(B_i) P(A|B_i)}{\sum_{j = 1}^n P(B_j) P(A|B_j)}, i = 1, 2, \cdots, n.

证明 由条件概率的定义

P(B_i|A) = \dfrac{P(A B_i)}{P(A)}.

对上式的分子用乘法公式、分母用全概率公式，

P(A B_i) = P(B_i) P(A|B_i),

P(A) = \sum_{j = 1}^n P(B_j) P(A|B_j),

即得

P(B_i|A) = \dfrac{P(B_i) P(A|B_i)}{\sum_{j = 1}^n P(B_j) P(A|B_j)}

结论得证。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
例 某地区居民的肝癌发病率为0.0004，现用甲胎蛋白法进行普查。医学研究表明，化验结果是存有错误的。已知患有肝癌的人其化验结果99%呈阳性（有病），而没患肝癌的人其化验结果99.9%呈阴性（无病）。现某人的检查结果呈阳性，问他真的患肝癌的概率是多少？

解 记B为事件“被检查者患有肝癌”，A为事件“检查结果呈阳性”。由题设知

P(B) = 0.0004, P(\bar{B}) = 0.9996,
P(A|B) = 0.99, P(A|\bar{B}) = 0.001.

我们现在的目的是求P(B|A)。由贝叶斯公式得

P(B|A) = \dfrac{P(B) P(A|B)}{P(B) P(A|B) + P(\bar{B}) P(A|\bar{B})} = \dfrac{0.0004 × 0.99}{0.0004 × 0.99 + 0.9996 × 0.001} = 0.284.

这表明，在检查结果呈阳性的人中，真患肝癌的人不到30%。这个结果可能会使人吃惊，但仔细分析一下就可以理解了。因为肝癌发病率很低，在10000个人中约有4人，而约有9996个人不患肝癌。对10000个人用甲胎蛋白法进行检查，按其错检的概率可知，9996个不患肝癌者中约有9996×0.001=9.996个呈阳性。另外4个真患肝癌者的检查报告中约有4×0.99=3.96个呈阳性。仅从13.956个呈阳性者中看，真患肝癌的3.96人约占28.4%。

进一步降低错检的概率是提高检验精度的关键。在实际中由于技术和操作等种种原因，降低错检的概率又是很困难的。所以在实际中，常采用复查的方法来减少错误率。或用另一些简单易行的辅助方法先进行初查，排除了大量明显不是肝癌的人后，再用甲胎蛋白法对被怀疑的对象进行检查。此时被怀疑的对象群体中，肝癌的发病率已大大提高了，譬如，对首次检查得阳性得人群再进行复查，此时P(B) = 0.284，这时再用贝叶斯公式计算得

P(B|A) = \dfrac{0.284 × 0.99}{0.284 × 0.99 + 0.716 × 0.001} = 0.997.

这就大大提高了甲胎蛋白法的准确率了。

在上例中，如果我们将事件B（“被检查者患有肝癌”）看作是“原因”，将事件A（“检查结果呈阳性”）看作是最后“结果”，则我们用贝叶斯公式在已知“结果”的条件下，求出了“原因”的概率P(B|A)。而求“结果”的（无条件）概率P(A)，用全概率公式。在上例中若取P(B) = 0.284，则

P(A) = P(B) P(A|B) + P(\bar{B}) P(A|\bar{B}) = 0.284 × 0.99 + 0.716 × 0.001 = 0.2819.

条件概率的三个公式中，乘法公式是求事件交的概率，全概率公式是求一个复杂事件的概率，而贝叶斯公式是求一个条件概率。

在贝叶斯公式中，如果称P(B_i)为B_i的先验概率，称P(B_i|A)为B_i的后验概率，则贝叶斯公式是专门用于计算后验概率的，也就是通过A的发生这个新信息，来对B_i的概率作出的修正。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
例 伊索寓言“孩子与狼”讲的是一个小孩每天到山上放羊，山里有狼出没。第一天，他在山上喊：“狼来了！狼来了！”，山下的村民闻声便去打狼，可到山上，发现狼没有来；第二天仍是如此；第三天，狼真的来了，可无论小孩怎么喊叫，也没有人来救他，因为前两次他说了谎，人们不再相信他了。

现在用贝叶斯公式来分析此寓言中村民对这个孩子的可信程度是如何下降的。

首先记事件A为“小孩说谎”，记事件B为“小孩可信”。不妨设村民过去对这个小孩的印象为

P(B) = 0.8, P(\bar{B}) = 0.2

我们现在用贝叶斯公式来求P(B|A)，亦即这个小孩说了一次谎后，村民对他可信程度的改变。

在贝叶斯公式中我们要用到概率P(A|B)和P(A|\bar{B})，这两个概率的含义是：前者为“可信”(B)的孩子“说谎”(A)的可能性，后者为“不可信”(\bar{B})的孩子“说谎”(A)的可能性。在此不妨设

P(A|B) = 0.1, P(A|\bar{B}) = 0.5

第一次村民上山打狼，发现狼没有来，即小孩说了谎(A)。村民根据这个信息，对这个小孩的可信程度改变为（用贝叶斯公式）

P(B|A) = \dfrac{P(B) P(A|B)}{P(B) P(A|B) + P(\bar{B}) P(A|\bar{B})} = \dfrac{0.8 × 0.1}{0.8 × 0.1 + 0.2 × 0.5} = 0.444

这表明村民上了一次当后，对这个小孩的可信程度由原来的0.8调整为0.444，也就是调整为

P(B) = 0.444, P(\bar{B}) = 0.556

在此基础上，我们再一次用贝叶斯公式来计算P(B|A)，亦即这个小孩第二次说谎后，村民对他的可信程度改变为

P(B|A) = \dfrac{0.444 × 0.1}{0.444 × 0.1 + 0.556 × 0.5} = 0.138

这表明村民们经过两次上当，对这个小孩的可信程度已经从0.8下降到了0.138，如此低的可信度，村民听到第三次呼叫时怎么再会上山打狼呢？

这个例子启发人们：若某人向银行贷款，连续两次未还，银行还会第三次贷款给他吗？
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
