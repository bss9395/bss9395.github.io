
### 后验概率

——摘录自《概率论与数理统计教程（第二版）》ISBN:978-7-04-031210-2，茆诗松/程依明/濮晓龙

**贝叶斯公式**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
在乘法公式和全概率公式的基础上立即可推得一个很著名的公式。

性质（贝叶斯公式） 设B_1, B_2, \cdots, B_n是样本空间\Omega的一个分割，即B_1, B_2, \cdots, B_n互不相容，且\bigcup\limits_{i = 1}^n B_i = \Omega，如果P(A) > 0, P(B_i) > 0, i = 1, 2, \cdots, n，则

P(B_i|A) = \dfrac{P(B_i) P(A|B_i)}{\sum_{j = 1}^n P(B_j) P(A|B_j)}, i = 1, 2, \cdots, n.

证明 由条件概率的定义

P(B_i|A) = \dfrac{P(A B_i)}{P(A)}.

对上式的分子用乘法公式、分母用全概率公式，

P(A B_i) = P(B_i) P(A|B_i),

P(A) = \sum_{j = 1}^n P(B_j) P(A|B_j),

即得

P(B_i|A) = \dfrac{P(B_i) P(A|B_i)}{\sum_{j = 1}^n P(B_j) P(A|B_j)}

结论得证.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
例 某地区居民的肝癌发病率为0.0004，现用甲胎蛋白法进行普查。医学研究表明，化验结果是存有错误的。已知患有肝癌的人其化验结果99%呈阳性（有病），而没患肝癌的人其化验结果99.9%呈阴性（无病）。现某人的检查结果呈阳性，问他真的患肝癌的概率是多少？

解 记B为事件“被检查者患有肝癌”，A为事件“检查结果呈阳性”。由题设知

P(B) = 0.0004, P(\bar{B}) = 0.9996,
P(A|B) = 0.99, P(A|\bar{B}) = 0.001.

我们现在的目的是求P(B|A)。由贝叶斯公式得

P(B|A) = \dfrac{P(B) P(A|B)}{P(B) P(A|B) + P(\bar{B}) P(A|\bar{B})} = \dfrac{0.0004 × 0.99}{0.0004 × 0.99 + 0.9996 × 0.001} = 0.284.

这表明，在检查结果呈阳性的人中，真患肝癌的人不到30%。这个结果可能会使人吃惊，但仔细分析一下就可以理解了。因为肝癌发病率很低，在10000个人中约有4人，而约有9996个人不患肝癌。对10000个人用甲胎蛋白法进行检查，按其错检的概率可知，9996个不患肝癌者中约有9996×0.001=9.996个呈阳性。另外4个真患肝癌者的检查报告中约有4×0.99=3.96个呈阳性。仅从13.956个呈阳性者中看，真患肝癌的3.96人约占28.4%。

进一步降低错检的概率是提高检验精度的关键。在实际中由于技术和操作等种种原因，降低错检的概率又是很困难的。所以在实际中，常采用复查的方法来减少错误率。或用另一些简单易行的辅助方法先进行初查，排除了大量明显不是肝癌的人后，再用甲胎蛋白法对被怀疑的对象进行检查。此时被怀疑的对象群体中，肝癌的发病率已大大提高了，譬如，对首次检查得阳性得人群再进行复查，此时P(B) = 0.284，这时再用贝叶斯公式计算得

P(B|A) = \dfrac{0.284 × 0.99}{0.284 × 0.99 + 0.716 × 0.001} = 0.997.

这就大大提高了甲胎蛋白法的准确率了。

在上例中，如果我们将事件B（“被检查者患有肝癌”）看作是“原因”，将事件A（“检查结果呈阳性”）看作是最后“结果”，则我们用贝叶斯公式在已知“结果”的条件下，求出了“原因”的概率P(B|A)。而求“结果”的（无条件）概率P(A)，用全概率公式。在上例中若取P(B) = 0.284，则

P(A) = P(B) P(A|B) + P(\bar{B}) P(A|\bar{B}) = 0.284 × 0.99 + 0.716 × 0.001 = 0.2819.

条件概率的三个公式中，乘法公式是求事件交的概率，全概率公式是求一个复杂事件的概率，而贝叶斯公式是求一个条件概率。

在贝叶斯公式中，如果称P(B_i)为B_i的先验概率，称P(B_i|A)为B_i的后验概率，则贝叶斯公式是专门用于计算后验概率的，也就是通过A的发生这个新信息，来对B_i的概率作出的修正。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
例 伊索寓言“孩子与狼”讲的是一个小孩每天到山上放羊，山里有狼出没。第一天，他在山上喊：“狼来了！狼来了！”，山下的村民闻声便去打狼，可到山上，发现狼没有来；第二天仍是如此；第三天，狼真的来了，可无论小孩怎么喊叫，也没有人来救他，因为前两次他说了谎，人们不再相信他了。

现在用贝叶斯公式来分析此寓言中村民对这个孩子的可信程度是如何下降的。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
